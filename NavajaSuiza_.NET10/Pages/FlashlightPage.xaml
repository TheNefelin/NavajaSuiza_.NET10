<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:extensions="clr-namespace:NavajaSuiza_.NET10.Extensions"
             xmlns:converters="clr-namespace:NavajaSuiza_.NET10.Converters"
             x:Class="NavajaSuiza_.NET10.Pages.FlashlightPage"
             Title="{extensions:Translate FlashlightText}">

    <ContentPage.Resources>
        <converters:BoolToColorConverter 
            x:Key="ToggleLight"
            TrueColor="{StaticResource MyOn}"
            FalseColor="{StaticResource MyOff}" />
        <converters:BoolToLocalizedStringConverter 
            x:Key="BoolToStatusText"
            TrueResourceKey="FlashlightStatusOffText"
            FalseResourceKey="FlashlightStatusOnText" />
        <converters:BoolToLocalizedStringConverter 
            x:Key="BoolToActionText"
            TrueResourceKey="FlashlightActionOffText"
            FalseResourceKey="FlashlightActionOnText" />        
    </ContentPage.Resources>
    
    <ScrollView>
        <VerticalStackLayout 
            Padding="20,40"
            Spacing="20">

            <Image Source="icon_flashlight.svg" WidthRequest="100">
                <Image.Behaviors>
                    <toolkit:IconTintColorBehavior TintColor="{StaticResource MyAccentOrange}" />
                </Image.Behaviors>
            </Image>

            <Label 
                Text="{extensions:Translate FlashlightOptionsText}"
                FontSize="12"
                HorizontalTextAlignment="Center"
                Opacity="0.6" />

            <Grid ColumnDefinitions="auto,auto" HorizontalOptions="Center">
                <Button
                    Grid.Column="0"
                    Command="{Binding ClickFlashCommand}"
                    Text="{extensions:Translate FlashlightOpFlashText}"
                    ImageSource="icon_flash.svg"
                    FontAttributes="Bold"
                    ContentLayout="Top, 0" 
                    Margin="8,0,8,16"
                    Padding="25,15,25,10"
                    WidthRequest="120" 
                    HeightRequest="120"
                >
                    <Button.Triggers>
                        <DataTrigger TargetType="Button" Binding="{Binding IsFlashOn}" Value="True">
                            <Setter Property="BackgroundColor" Value="{StaticResource MyAccent}" />
                            <Setter Property="TextColor" Value="{StaticResource MyPrimaryDark}" />
                        </DataTrigger>
                    </Button.Triggers>
                    <Button.Behaviors>
                        <toolkit:IconTintColorBehavior TintColor="{StaticResource MyAccentOrange}" />
                    </Button.Behaviors>
                </Button>

                <Button
                    Grid.Column="1"
                    Command="{Binding ClickScreenCommand}"          
                    Text="{extensions:Translate FlashlightOpScreenText}"                  
                    ImageSource="icon_mobile_screen.svg"
                    FontAttributes="Bold"
                    ContentLayout="Top, 0" 
                    Margin="8,0,8,16"
                    Padding="33,15,33,10"
                    WidthRequest="120" 
                    HeightRequest="120" 
                >
                    <Button.Triggers>
                        <DataTrigger TargetType="Button" Binding="{Binding IsScreenOn}" Value="True">
                            <Setter Property="BackgroundColor" Value="{StaticResource MyAccent}" />
                            <Setter Property="TextColor" Value="{StaticResource MyPrimaryDark}" />
                        </DataTrigger>
                    </Button.Triggers>                    
                    <Button.Behaviors>
                        <toolkit:IconTintColorBehavior TintColor="{StaticResource MyAccentOrange}" />
                    </Button.Behaviors>
                </Button>
            </Grid>
         
            <!-- Estado de la linterna -->
            <Border
                Padding="20"
                StrokeShape="16">

                <VerticalStackLayout 
                    Spacing="12"
                    HorizontalOptions="Center">

                    <HorizontalStackLayout 
                        Spacing="8"
                        HorizontalOptions="Center">

                        <Ellipse 
                            x:Name="StatusIndicator"
                            WidthRequest="15"
                            HeightRequest="15"
                            Fill="{Binding IsLightOn, Converter={StaticResource ToggleLight}}"
                            VerticalOptions="Center" />

                        <Label 
                            x:Name="StatusLabel"
                            Text="{Binding IsLightOn, Converter={StaticResource BoolToStatusText}}"
                            FontSize="16"
                            FontAttributes="Bold"
                            VerticalOptions="Center" />
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Border>

            <!-- BotÃ³n principal de encendido/apagado -->
            <Button 
                Command="{Binding ClickLightCommand}"
                TextColor="{StaticResource MyPrimaryLight}"
                BackgroundColor="{StaticResource MyAccentGreen}"
                Text="{Binding IsLightOn, Converter={StaticResource BoolToActionText}}"
                FontSize="18"
                FontAttributes="Bold"
                Padding="24,18"
                CornerRadius="16" />

            <!-- Nota informativa -->
            <Label 
                Text="{extensions:Translate FlashlightNote}"
                FontSize="12"
                HorizontalTextAlignment="Center"
                Opacity="0.6"
                Padding="16" />

        </VerticalStackLayout>
    </ScrollView>
    
</ContentPage>